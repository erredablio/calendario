# üìå Guia da API - Calend√°rio API

## üì¢ Introdu√ß√£o
Esta API permite o gerenciamento de usu√°rios e tarefas. Apenas **usu√°rios administradores (`admin`)** podem gerenciar usu√°rios, enquanto **usu√°rios comuns (`common`)** t√™m permiss√µes restritas.

## üîπ Inicializa√ß√£o do Projeto  
Para rodar a API localmente, siga os passos:

### **1Ô∏è‚É£ Instalar depend√™ncias**
```bash
pip install -r requirements.txt
```
### **2Ô∏è‚É£ Configurar banco de dados**
```bash
flask db migrate
flask db upgrade
```
### **3Ô∏è‚É£ Rodar o servidor**
```bash
python3 app.py
```
Agora a API estar√° dispon√≠vel em:
http://127.0.0.1:5000
üîê Diferen√ßa entre usu√°rios admin e common
Admin: Pode listar, criar e modificar usu√°rios (incluindo role).
Common: Pode modificar apenas suas pr√≥prias informa√ß√µes e n√£o pode alterar a role.
Tokens JWT: Ambos os tipos de usu√°rios recebem tokens JWT, mas o role define os n√≠veis de acesso.

## üìå Endpoints da API

### **1Ô∏è‚É£ Registro de Usu√°rio (POST /register)**
Cria um novo usu√°rio com dados adicionais.

**POST /register**
```json
Headers: 
    Authorization: None
    Content-Type: application/json
Body:
{
    "username": "usuario_teste",
    "password": "senha_segura",
    "role": "common",
    "full_name": "Nome Completo",
    "gender": "male",
    "email": "usuario@email.com",
    "phone": "+55 99999-9999",
    "profile_picture": "https://example.com/foto.jpg"
}
```
#### ‚úÖ Resposta de sucesso (201):
```json
{"msg": "Usu√°rio registrado com sucesso"}
```
#### ‚ùå Usu√°rio j√° existe (400):
```json
{"msg": "Usu√°rio j√° existe"}
```
### **2Ô∏è‚É£ Login (POST /login)**
Autentica um usu√°rio e gera um JWT.

**POST /login**
```json
Headers: 
    Authorization: None
    Content-Type: application/json
Body:
{
    "username": "usuario_teste",
    "password": "senha_segura"
}
```
#### **‚úÖ Resposta de sucesso (200):**
```json
{
    "access_token": "eyJh...token_exemplo..."
}
```
#### **‚ùå Credenciais inv√°lidas (401):**
```json
{"msg": "Credenciais inv√°lidas"}
```
### **3Ô∏è‚É£ Listagem de Usu√°rios (GET /users)**

**GET /users**
```json
Headers: 
    Authorization: Bearer SEU_TOKEN_ADMIN
```
#### **‚úÖ Resposta de sucesso (200):**
```json
[
    {
        "id": "1234",
        "username": "admin_user",
        "role": "admin",
        "email": "admin@email.com",
        "active": true
    },
    {
        "id": "5678",
        "username": "user_common",
        "role": "common",
        "email": "user@email.com",
        "active": true
    }
]
```
#### **‚ùå Usu√°rio sem permiss√£o (403):**
```json
{"msg": "Acesso negado"}
```
### **4Ô∏è‚É£ Atualiza√ß√£o de Usu√°rio (PUT /users/<user_id>)**
üîπ Usu√°rios comuns podem atualizar suas pr√≥prias informa√ß√µes. üîπ Apenas admins podem alterar role.
**PUT /users/1234**
```json
Headers: 
    Authorization: Bearer SEU_TOKEN
    Content-Type: application/json
Body:
{
    "full_name": "Novo Nome",
    "email": "novo@email.com",
    "phone": "+55 99999-9999",
    "profile_picture": "https://example.com/foto.jpg",
    "password": "nova_senha"
}
```
#### **‚úÖ Resposta de sucesso (200):**
```json
{"msg": "Usu√°rio atualizado"}
```
#### **‚ùå Acesso negado (403):**
```json
{"msg": "Acesso negado"}
```
### **5Ô∏è‚É£ Desativar Usu√°rio (PUT /users/<user_id>/deactivate)**
üîπ Apenas usu√°rios admin podem desativar um usu√°rio.
**PUT /users/1234/deactivate**
```json
Headers: 
    Authorization: Bearer SEU_TOKEN_ADMIN
```
**‚úÖ Resposta de sucesso (200):**
```json
{"msg": "Usu√°rio desativado"}
```
**‚ùå Usu√°rio sem permiss√£o (403):**
```json
{"msg": "Acesso negado"}
```
### **6Ô∏è‚É£ Criar Tarefa (POST /tasks)**
Cria uma nova tarefa associada ao usu√°rio logado.
**POST /tasks**
```json
Headers: 
    Authorization: Bearer SEU_TOKEN
    Content-Type: application/json
Body:
{
    "event_date": "2025-05-24",
    "description": "Reuni√£o de planejamento"
}
```
**‚úÖ Resposta de sucesso (201):**
```json
{"msg": "Tarefa criada"}
```
### **7Ô∏è‚É£ Listar Tarefas (GET /tasks)**
üîπ Usu√°rios podem visualizar apenas suas pr√≥prias tarefas.
**GET /tasks**
```json
Headers: 
    Authorization: Bearer SEU_TOKEN
```
#### **‚úÖ Resposta de sucesso (200):**
```json
[
    {
        "id": "task_123",
        "event_date": "2025-05-24",
        "description": "Reuni√£o de planejamento"
    }
]
```
### **8Ô∏è‚É£ Excluir Tarefa (DELETE /tasks/<task_id>)**
üîπ Usu√°rios podem excluir apenas suas pr√≥prias tarefas.
**DELETE /tasks/task_123**
```json
Headers: 
    Authorization: Bearer SEU_TOKEN
```
#### **‚úÖ Resposta de sucesso (200):**
```json
{"msg": "Tarefa exclu√≠da"}
```
## üîê Configura√ß√£o do `.env`  

Para garantir seguran√ßa, a API utiliza um arquivo **`.env`** para armazenar **credenciais sens√≠veis** como JWT Secret Key.

### **1Ô∏è‚É£ Criar o arquivo `.env`**
No diret√≥rio raiz do projeto, crie um arquivo `.env`:
```ini
JWT_SECRET_KEY=super_seguro_token_aleatorio_12345
```
*Este guia, tal como todo o c√≥digo do reposit√≥rio, foram gerados pelo Copilot da Microsot üöÄ*
